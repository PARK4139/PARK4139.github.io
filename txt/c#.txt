# 

using System;

using System.Collections.Generic;

using System.ComponentModel;

using System.Data;

using System.Drawing;

using System.IO;

using System.Linq;

using System.Text;

using System.Threading.Tasks;

using System.Windows.Forms;

namespace Test

{

	public partial class Form1 : Form

	{

		public Form1()

		{

			InitializeComponent();

			this.Load += Test_Load;

		}

		/// <summary>

		/// 폼 Load 이벤트 핸들러

		/// </summary>

		/// <param name="sender"></param>

		/// <param name="e"></param>

		public void Test_Load(object sender, EventArgs e)

		{

			//용량 체크

			GetDriveSize();

		}

		/// <summary>

		/// Local 드라이브 찾기

		/// </summary>

		public void GetDriveSize()

		{

			DriveInfo[] drives = DriveInfo.GetDrives();

			foreach (DriveInfo drive in drives)

			{

			 if (drive.DriveType == DriveType.Fixed)

			 {

				if (drive.Name.Contains("C")) //C 드라이브

				{

					SetDriveSize(drive, uiPgb_CDrive, uiLb_CDrive_Title, uiLb_CDrive);

				}

				else //D 드라이브

				{

					SetDriveSize(drive, uiPgb_DDrive, uiLb_DDrive_Title, uiLb_DDrive);

				}

			 }

			}

		}

		/// <summary>
		/// 드라이브 전체 용량, 사용량, 남은량 구하기
		/// 컨트롤에 값 저장
		/// </summary>
		/// <param name="drive"></param>
		public void SetDriveSize(DriveInfo drive, ProgressBar pb, Label title, Label lb)
		{
			string driveName = string.Empty;
			string totalSize = string.Empty;
			string freeSize = string.Empty;
			string usage = string.Empty;
			try
			{
				driveName = drive.Name.Substring(0, 1).ToString();
				totalSize = Convert.ToInt32(drive.TotalSize / 
1024 / 1024 / 1024).ToString(); //전체 사이즈
				freeSize = Convert.ToInt32(drive.AvailableFreeSpace 
/ 1024 / 1024 / 1024).ToString(); //남은 사이즈
				usage = (Convert.ToInt32(totalSize) - 
Convert.ToInt32(freeSize)).ToString(); //사용 용량
				pb.Maximum = Convert.ToInt32(totalSize);
				pb.Value = Convert.ToInt32(usage);
				title.Text = string.Format("Disk ({0}:)", driveName);
				title.AutoSize = true;
				lb.Text = string.Format("{0}GB of {1}GB available.", totalSize, freeSize);
				lb.AutoSize = true;
			}
			catch { }
		}
	}
}

	